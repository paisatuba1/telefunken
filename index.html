<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>TELEFUKER</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<style>
*{
  box-sizing:border-box;
  font-family: Arial, sans-serif;
  -webkit-tap-highlight-color: transparent;
}

html,body{
  margin:0;
  padding:0;
  background:#000;
  color:#fff;
  height:100%;
  overflow:hidden;
  touch-action: manipulation;
}

/* ===== HEADER ===== */
header{
  text-align:center;
  padding:10px 0;
  font-size:26px;
  font-weight:bold;
}

/* ===== CONTENEDOR PRINCIPAL ===== */
.app{
  height:100vh;
  display:flex;
  flex-direction:column;
}

/* ===== GRID DE JUGADORES ===== */
.players{
  flex:1;
  display:grid;
  grid-template-columns:1fr 1fr;
  grid-template-rows:1fr 1fr;
  gap:8px;
  padding:8px;
}

.player{
  border:2px solid #444;
  border-radius:10px;
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  padding:8px;
}

.player-name{
  text-align:center;
  font-weight:bold;
}

.score{
  text-align:center;
  font-size:48px;
  margin:10px 0;
}

.controls{
  display:flex;
  gap:6px;
}

.controls button{
  flex:1;
  font-size:16px;
  padding:6px;
}

/* ===== BARRA INFERIOR ===== */
.footer{
  padding:8px;
  display:flex;
  gap:8px;
}

/* Botones inferiores */
.footer button{
  flex:1;
  padding:10px;
  font-size:16px;
  border-radius:8px;
}

/* ===== MODAL ===== */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:10;
}

.modal-content{
  background:#111;
  border:2px solid #555;
  padding:16px;
  width:90%;
  max-width:400px;
  border-radius:10px;
  text-align:center;
}

.modal-content button{
  margin-top:12px;
  padding:8px 16px;
}
</style>
</head>

<body>
<div class="app">

<header>TELEFUKER</header>

<div class="players" id="players"></div>

<div class="footer">
  <button onclick="finalizarPartida()">FINALIZAR</button>
  <button onclick="verConsolidado()">CONSOLIDADO</button>
</div>

</div>

<!-- MODAL -->
<div class="modal" id="modal">
  <div class="modal-content" id="modalContent"></div>
</div>

<script>
/* =========================
   1️⃣ ESTADO DEL JUEGO
========================= */

const state = {
  players:[
    {name:"Jugador 1", score:0},
    {name:"Jugador 2", score:0},
    {name:"Jugador 3", score:0},
    {name:"Jugador 4", score:0},
  ]
};

/* =========================
   2️⃣ RENDER
========================= */

function render(){
  const container = document.getElementById("players");
  container.innerHTML = "";

  state.players.forEach((p,i)=>{
    const div = document.createElement("div");
    div.className = "player";
    div.innerHTML = `
      <div class="player-name">${p.name}</div>
      <div class="score">${p.score}</div>
      <div class="controls">
        <button onclick="sumar(${i})">+</button>
        <button onclick="restar(${i})">−</button>
      </div>
    `;
    container.appendChild(div);
  });
}

function sumar(i){
  state.players[i].score++;
  render();
}

function restar(i){
  if(state.players[i].score > 0){
    state.players[i].score--;
    render();
  }
}

/* =========================
   3️⃣ FINALIZAR PARTIDA
   (SOLO LECTURA)
========================= */

function finalizarPartida(){
  const min = Math.min(...state.players.map(p=>p.score));
  const ganador = state.players.find(p=>p.score === min);

  abrirModal(`
    <h3>¿Finalizar partida?</h3>
    <p>Ganador: <b>${ganador.name}</b><br>Puntos: ${min}</p>
    <button onclick="confirmarGanador('${ganador.name}')">CONFIRMAR</button>
    <button onclick="cerrarModal()">CANCELAR</button>
  `);
}

function confirmarGanador(nombre){
  const data = JSON.parse(localStorage.getItem("telefuker_consolidado")) || {};

  state.players.forEach(p=>{
    if(!(p.name in data)) data[p.name] = 0;
  });

  data[nombre]++;
  localStorage.setItem("telefuker_consolidado", JSON.stringify(data));
  cerrarModal();
}

/* =========================
   4️⃣ CONSOLIDADO
========================= */

function verConsolidado(){
  const data = JSON.parse(localStorage.getItem("telefuker_consolidado")) || {};
  let html = "<h3>Consolidado</h3>";

  for(const jugador in data){
    html += `<p>${jugador}: ${data[jugador]} partidas</p>`;
  }

  html += `<button onclick="cerrarModal()">CERRAR</button>`;
  abrirModal(html);
}

/* =========================
   5️⃣ MODAL
========================= */

function abrirModal(html){
  document.getElementById("modalContent").innerHTML = html;
  document.getElementById("modal").style.display = "flex";
}

function cerrarModal(){
  document.getElementById("modal").style.display = "none";
}

/* INIT */
render();
</script>
</body>
</html>